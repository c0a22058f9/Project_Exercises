<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>商品検索</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
</head>
<body>
    <div class="container">
        <h2>商品検索</h2>
        <div class="row">
            <div class="input-field col s12">
                <input type="text" id="search" class="autocomplete">
                <label for="search">商品名で検索</label>
                <ul id="suggestions" class="dropdown-content" style="display: none;"></ul>
            </div>
        </div>
    </div>

    <!-- Materialize JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <!-- jQuery (for AJAX) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Custom JS -->
    <script>
        $(document).ready(function() {
            $('#search').on('input', function() {
                var query = $(this).val();
                if (query.length > 0) {
                    $.ajax({
                        url: 'autocomplete.php',
                        method: 'GET',
                        data: { query: query },
                        success: function(data) {
                            var suggestions = JSON.parse(data);
                            var $suggestionsList = $('#suggestions');
                            $suggestionsList.empty();
                            if (suggestions.length > 0) {
                                suggestions.forEach(function(suggestion) {
                                    $suggestionsList.append('<li><a href="product.php?id=' + suggestion.id + '">' + suggestion.name + '</a></li>');
                                });
                                $suggestionsList.show();
                            } else {
                                $suggestionsList.hide();
                            }
                        }
                    });
                } else {
                    $('#suggestions').hide();
                }
            });
        });
    </script>
</body>
</html>
